{{
config(
materialized='incremental',
incremental_strategy='merge',
unique_key='LIFNR'
)
}}
/*
    Uncomment the line below to remove records with null `id` values
*/
with dim_vendor as
(SELECT
 ATTR.LIFNR,
ANRED,
BAHNS,
BBBNR,
BBSNR,
BEGRU,
BRSCH,
BUBKZ,
DATLT,
DTAMS,
DTAWS,
ERDAT,
ERNAM,
ESRNR,
KONZS,
KTOKK,
KUNNR,
LAND1,
LNRZA,
LOEVM,
NAME1,
NAME2,
NAME3,
NAME4,
ORT01,
ORT02,
PFACH,
PSTL2,
PSTLZ,
REGIO,
SORTL,
SPERR,
SPERM,
SPRAS,
STCD1,
STCD2,
STCD3,
STKZA,
STKZU,
STRAS,
TELBX,
TELF1,
TELF2,
TELFX,
TELTX,
TELX1,
XCPDK,
XZEMP,
VBUND,
FISKN,
STCEG,
STKZN,
SPERQ,
MCOD1,
MCOD2,
MCOD3,
GBORT,
GBDAT,
SEXKZ,
KRAUS,
REVDB,
QSSYS,
KTOCK,
PFORT,
WERKS,
LTSNA,
WERKR,
PLKAL,
TXJCD,
SPERZ,
 TXTMD AS VENDOR_NM --vendor name
 FROM "ARRAY_DB"."ARRAY_DB_EDW"."VENDOR_ATTR" ATTR LEFT OUTER JOIN "ARRAY_DB"."ARRAY_DB_EDW"."VENDOR_TEXT" TXT ON (ATTR.LIFNR=TXT.LIFNR)
 )
 select * from dim_vendor 
